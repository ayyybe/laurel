<!doctype html>
<html lang="en">
<meta charset="utf-8">
<title>Laurel</title>
<style>
input[type=range] { width: 500px; }
</style>
<script src="laurel_base64.js"></script>
<script src="PitchShifter.js"></script>
<script>

function init() {
	AudioContext = window.AudioContext || window.webkitAudioContext;
	context = new AudioContext();
	context.suspend();
	data = Uint8Array.from(atob(laurel_base64), c => c.charCodeAt(0));
	context.decodeAudioData(data.buffer, function(buffer) {
		shifter = new PitchShifter(context);
		source = context.createBufferSource();
		source.buffer = buffer;
		source.loop = true;
		source.connect(shifter);
		source.start();
		shifter.connect(context.destination);
		update();
	});
}

function play() {
	context.state=='suspended' ? context.resume() : context.suspend();
	update();
}

function update() {
	rate = parseFloat(document.getElementById("rate").value);
	document.getElementById("pitch").innerText = rate.toFixed(2);
	shifter.pitchRatio = rate;
	document.getElementById("play").value = context.state=='suspended' ? "Click To Play" : "Click To Pause";
}

</script>
<body onload=init()>
<h2>Laurel - Pitch shift version</h2>
<input type=button id=play value=play onclick=play()><br>
<input type=range id=rate value=1 min=0.5 max=1.5 step=0.01 oninput=update()>
Pitch: <label id=pitch></label>
<p><a href="https://github.com/joric/laurel">GitHub</a>
</body>
</html>
